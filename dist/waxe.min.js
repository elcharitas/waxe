(function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Wax=e()})(function(){return function r(i,o,u){function c(t,e){if(!o[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(n=Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}},i[t][0].call(n.exports,function(e){return c(i[t][1][e]||e)},n,n.exports,r,i,o,u)}return o[t].exports}for(var s="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(r,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conflictProp=t.encodeHTML=t.WaxDelimiter=t.WaxTemplate=t.WaxConfig=void 0;var i=r("../debug");function n(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"};return"string"==typeof e?e.replace(/&(?!#?\w+;)|<|>|"|'|\//g,function(e){return t[e]||e}):e}function o(t,e){void 0===e&&(e=Object.keys(t));var n={writable:!1,configurable:!1};e.forEach(function(e){Object.defineProperty(t,e,n)})}t.encodeHTML=n,t.conflictProp=o;function u(e){return void 0===e&&(e={}),null}t.WaxTemplate=u;var c={blockSyntax:"@(\\w+)(\\([^@]+\\))?",tagName:1,argList:2,endPrefix:"end"},c={strip:!0,throwUndefined:!1,autoescape:!0,delimiter:t.WaxDelimiter=c,context:{startTime:Date.now(),now:function(){return Date.now()},escape:function(e,t){return void 0===t&&(t=!1),e=n(e),!0===t&&(e=(escape||String)(e)),e},merge:function(e){var n=this;void 0===e&&(e=[]),(e=[].slice.call(e)).forEach(function(e){for(var t in e)t in n&&!0!==Object.getOwnPropertyDescriptor(n,t).configurable||(n[t]=e[t])})},reverse:function(e,t){return void 0===t&&(t=""),e.split(t).reverse().join(t)},template:function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!1);e=r("../waxe").template(e);return 0!=n||e||i.dbg(e,u),(e||u)(t)}}};o(t.WaxConfig=c),o(c.context)},{"../debug":4,"../waxe":9}],2:[function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.parseTemplate=s.parseString=s.traverseNode=s.out=void 0;var a=e("."),f=n(e("./walker"));function r(e,t,n){var r,i,o,u,c,t=(r=t,i=n.delimiter,o=i.argList,u=i.blockSyntax,c=i.tagName,t=i.endPrefix,i=JSON.stringify(r),r=i.match(RegExp("("+u+")","g")),{text:i,directives:r,argList:o,blockSyntax:u,tagName:c,endPrefix:t}),t=new f.default(e,t).walk();return!0===n.strip&&(t=t.replace(/\\n\s+/g,"")),function(e){var t=a.WaxTemplate;try{t=Function(s.out,"this.merge(arguments);"+s.out+"+="+e+";return "+s.out)}catch(e){}return t}(t)}function u(e,r){var i=e.split(""),o=null;return i.forEach(function(e,t){var n=i[t+1];e==o||'"'!=o&&"'"!=o?o==e?o=null:o||"$"!=e||"["==n?o||"$"!=e||"["!=n?o||";"!=e?!o&&r&&"#"==e&&"["==n&&(e="["+r.text()+"]"):(n=i[t-3]+i[t-2]+i[t-1]).match(/^&(g|l)t$/)&&(i[t-1]=i[t-2]=i[t-3]="",e=n.replace("&gt",">").replace("&lt","<")):e="this":e="this.":o=e,i[t]=e}),i.join("")}s.out="out",s.traverseNode=function(e,t){var n=t.tag,r=t.argLiteral,i="",o=null;return(o=e.parser.getTag(t))?(o.write=function(e){return s.out+"+="+o.exec(e)},o.exec=function(e){return u(e,r)},i=o.descriptor.call(o,r)):~e.jsTags.indexOf(n)?i=n+r.parse()+"{":e.isBlockEnd(n)&&(i="}"),i},s.parseString=u,s.parseTemplate=function(e,t,n){return void 0===e&&(e="waxe-"+Date.now()),void 0===t&&(t=""),void 0===n&&(n=null),e=e,t=r(n,t,n.getConfigs()),n=n,Function("call","return function "+e+"(){return call(this,arguments)}")(Function.apply.bind(t.bind(n.getConfigs().context,"")))}},{".":1,"./walker":3}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../debug"),a=e("./parser"),e=(i.prototype.walk=function(u,c){var e,s=this;return void 0===u&&(u=this.text),void 0===c&&(c=""),null!==(e=this.directives)&&void 0!==e&&e.forEach(function(e,t){var n=JSON.parse('"'+e+'"'),r=n.match(s.blockSyntax),i=r[s.tagName],o=r[s.argList],r=void 0===o?"":o,o=s.parser.getConfigs(),r=s.toArgs(r);if("extends"==i&&0==t)return c="+this.template("+r.arg(0)+")",u=u.replace(e,"");u=u.replace(e,'";'+a.traverseNode(s,{tag:i,argLiteral:r,block:n,position:t,configs:o,context:o.context})+";\n"+a.out+'+="')}),u+c},i.prototype.isBlockEnd=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=e.replace(this.endPrefix,"")),0==e.indexOf(this.endPrefix)&&(!!~this.jsTags.indexOf(t)||null!==this.parser.getTag({tag:t}))},i.prototype.toArgs=function(e){var t=new String(e);return t.arg=function(e){return"["+t.text()+"]["+e+"]"},t.parse=function(){return a.parseString(t)},t.text=function(){return t.parse().replace(/^\(([\s\S]*)\)$/,"$1")},t},i);function i(e,t){void 0===t&&(t={}),r.dbg("Walker",this),this.directives=t.directives,this.argList=t.argList,this.blockSyntax=t.blockSyntax,this.tagName=t.tagName,this.text=t.text,this.endPrefix=t.endPrefix,this.jsTags=["for","if","while","switch"],this.parser=e}n.default=e},{"../debug":4,"./parser":2}],4:[function(n,e,f){(function(t){(function(){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(f,"__esModule",{value:!0}),f.dbg=f.formatDbg=f.dbgType=f.debugProp=f.debugkit=void 0;var o=e(n("./list.json"));function c(e,t){return{}.hasOwnProperty.call(e,t)}function s(e,t,n){return typeof t!=typeof n&&e.push((null==n?void 0:n.name)||typeof n),void 0===t&&"object"==typeof n?e.push("initialized"):"object"!=typeof n&&e.push("declared"),e}function a(e,t){if(c(o,e)){var n=t.length-2,n=o[e][n],r=void 0===n?"":n;return t.forEach(function(e,t){r=r.replace("%"+(t+1),null==e?void 0:e.toString())}),r}}f.debugkit=void 0!==t?t:window,f.debugProp=c,f.dbgType=s,f.formatDbg=a,f.dbg=function(e,t,n,r){void 0===n&&(n={}),void 0===r&&(r="Type");var i=[],o=null==e?void 0:e.toString(),u=null;if(r+="Error",c(f.debugkit,r)&&(i=s([e],t,n),u=f.debugkit[r],o=a(r,i)),1<i.length&&null!==u)throw new u(o)}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./list.json":5}],5:[function(e,t,n){t.exports={TypeError:["%1 should be of %2's type","%1 should be %3 as a %2"]}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CoreDirectives=void 0;var r=(i.prototype.set=function(e){return"eval("+e.arg(0)+'+"="+'+JSON.stringify(e.arg(1))+");"},i.prototype.define=function(){return this.exec("$[#[0]]=#[1];")},i.prototype.comment=function(){},i.prototype.macro=function(){return this.exec('$[#[0]]=function(){var name=#[0];var call=$[name];var args=[].slice.call(arguments);var out = "";')},i.prototype.endmacro=function(){return"return out;}"},i.prototype.include=function(){return this.write("$template(#[0],#[1])")},i.prototype.yield=function(){return this.write("("+this.configs.autoescape+" ? $escape: String)(#[0]||#[1])")},i.prototype.elseif=function(e){return"}else if("+e+"){"},i.prototype.else=function(){return"}else{"},i.prototype.switch=function(e){return"switch"+e+"{/*"},i.prototype.case=function(e){return"*/case "+e+":"},i.prototype.break=function(e){return"break;/*"},i.prototype.continue=function(e){return"continue;"},i.prototype.endswitch=function(){return"*/}"},i.prototype.forelse=function(e){return"var loopObj = "+e.text().split(/\s+/)[2]+";for"+e+"{"},i.prototype.empty=function(){return'} if(typeof loopObj!=="object"||Object.keys(loopObj).length<1){'},i.prototype.endforelse=function(){return"};delete loopObj;"},i);function i(){}n.CoreDirectives=r},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CoreWax=void 0;var r=e("./core"),i=e("./misc"),e=function(e){this.directives=new(r.CoreDirectives.bind(new i.MiscDirectives))};n.CoreWax=e},{"./core":6,"./misc":8}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MiscDirectives=void 0;var r=(i.prototype.includeIf=function(){return this.write("$template(#[0],#[1],1)")},i.prototype.includeWhen=function(){return this.write("#[0]?$template(#[1],#[2]):''")},i.prototype.bind=function(){return this.write('$["bind"+#[0]]=#[1];setInterval(function(){document.querySelectorAll(#[0]).forEach(function(hook){if($["bind"+#[0]]!==#[1]){hook.value = this["bind"+#[0]]=#[1]}})})')},i.prototype.escape=function(){return this.write("$escape(#[0]||#[1])")},i.prototype.json=function(e){return this.write("JSON.stringify"+e)},i.prototype.js=function(){return"var hjs=out;"},i.prototype.endjs=function(){return this.exec('hjs=$reverse(out).replace($reverse(hjs),"");out=$reverse($reverse(out).replace(hjs,""));(new Function($reverse(hjs))).bind(this)();delete hjs')},i);function i(){}n.MiscDirectives=r},{}],9:[function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])!{}.hasOwnProperty.call(t,i)||(e[i]=t[i]);return e}).apply(this,arguments)},i=e("./debug"),o=e("./compiler"),u=e("./compiler/parser"),c=e("./plugins");function s(){i.dbg("Wax",this),this.configs=o.WaxConfig,this.tags={},this.templates={}}t.exports=(s.global=function(e,t){return void 0===t&&(t=null),this.core.configs.context[e]=t},s.directive=function(e,t){return this.core.tags[e]={tag:e,descriptor:t}},s.setDelimiter=function(e){return s.core.configs.delimiter=r(r({},s.getDelimiter()),e)},s.getConfigs=function(){return s.core.configs},s.getDelimiter=function(){return s.getConfigs().delimiter},s.getTag=function(e){var t=this.core.tags[e.tag]||null;return"object"==typeof t&&null!==t&&(t=r(r({},t),e)),t},s.addPlugin=function(e){var t,e=new e(this).directives,n=void 0===e?{}:e;for(t in n)"function"==typeof n[t]&&this.directive(t,n[t])},s.template=function(e,t,n){return void 0===n&&(n=this.getConfigs()),"string"==typeof t&&(this.core.templates[e]=u.parseTemplate(e,t,s)),this.core.templates[e]},s.resolve=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!0),"undefined"!=typeof document&&document.querySelectorAll(e).forEach(function(e){e.innerHTML=e.value=s.template(e.id,e.value||e.innerHTML)(t),"hidden"in e&&(e.hidden=!n)})},Object.defineProperty(s,"core",{get:function(){return this._core instanceof s||(this._core=new s,s.addPlugin(c.CoreWax)),this._core},enumerable:!1,configurable:!0}),s)},{"./compiler":1,"./compiler/parser":2,"./debug":4,"./plugins":7}]},{},[9])(9)});